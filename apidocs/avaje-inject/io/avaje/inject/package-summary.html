<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (15) on Wed Jul 21 21:41:57 NZST 2021 -->
<title>io.avaje.inject (avaje inject 6.5-RC0 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-07-21">
<meta name="description" content="declaration: package: io.avaje.inject">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package" class="title">Package&nbsp;io.avaje.inject</h1>
</div>
<section class="package-description" id="package.description">
<div class="block">Avaje Inject API - see <a href="BeanScope.html" title="interface in io.avaje.inject"><code>BeanScope</code></a>.

 <h2>Overview</h2>

 <h4>1. @Singleton / @Factory</h4>
 <p>
 Put <code>@Singleton</code> on beans that we want avaje-inject to wire.
 <p>
 We can use <code>@Factory/@Bean</code> to programmatically create dependencies
 when they have interesting construction logic (e.g. construction depends on
 system/environment properties etc - like Spring @Configuration).

 <pre><code>

   @Singleton
   public class CoffeeMaker { ... }

   @Singleton
   public class Pump { ... }

   // Use @Factory to programmatically build dependencies

   @Factory
   public class MyFactory {

     @Bean
     Grinder buildGrinder(Pump pump) { // interesting construction logic ... }

   }

 </code></pre>

 <h4>2. Create and use BeanScope</h4>
 <p>
 Create <a href="BeanScope.html" title="interface in io.avaje.inject"><code>BeanScope</code></a> using a builder.
 Obtain beans from the scope and use them.
 <p>
 We should ensure the BeanScope is closed in order to fire
 preDestroy lifecycle methods. We can do this via a shutdown
 hook, or try with resource block or explicitly via application code.

 <pre><code>

   // create BeanScope
   BeanScope scope = BeanScope.newBuilder()
     .build();

   // use it
   CoffeeMaker coffeeMaker = scope.get(CoffeeMaker.class);
   coffeeMaker.makeIt();

   // close it to fire preDestroy lifecycle methods
   scope.close();

 </code></pre>

 <h2>Default scope</h3>
 <p>
 All beans annotated with <code>@Singleton</code> and <code>@Factory</code> are by default included in
 the "default scope".
 <p>
 When we create a BeanScope and do not specify any modules then all the beans in the default
 scope are included. This is done via ServiceLoader and includes all 'default scope' modules
 that are in the classpath (other jars can have default scope modules and these are all included).

 <h4>Generated code</h4>
 <p>
 <em>avaje-inject</em> will generate a <code>$DI</code> class for each bean that it is going to
 wire - this has the code that instantiates the bean, performs field and method injection and
 lifecycle support (PostConstruct and PreDestroy).
 <p>
 <em>avaje-inject</em> will generate a Module class for the default scope. The main job of
 the module code is to specify the ordering of how all the beans are instantiated.
 <p>
 We typically find the generated source code in  <em>target/generate-sources/annotations</em>.


 <h2>Custom scopes</h3>
 <p>
 We can create custom scopes that only contain the beans/components that we want to include in
 that scope. These beans/components in the custom scope are not included in the default scope.
 <p>
 To do this we:

 <h4>1. Create the scope annotation</h4>
 <p>
 Create an annotation that has the <code>Scope</code> annotation. In the example below we create the
 <code>@StoreComponent</code> annotation. We will put this annotation on beans that we want
 included in the scope.

 <pre><code>

    @Scope
    public @interface StoreComponent {
    }

 </code></pre>

 <p>
 Note that if this scope depends on external dependencies or another scope we specify that via
 <code>@InjectModule requires</code>. In the example below our StoreComponent depends on another
 scope called QueueComponent and an external dependency - SomeExternalDependency.

 <pre><code>

    @Scope
    @InjectModule(requires = {QueueComponent.class, SomeExternalDependency.class})
    public @interface StoreComponent {
    }

 </code></pre>

 <h4>2. Use the annotation</h4>
 <p>
 Put the <code>@StoreComponent</code> annotation on the beans that we want included in the
 custom scope.

 <pre><code>

   @StoreComponent
   public class StoreLoader {
     ...
   }

 </code></pre>


 <h4>3. Generated Module</h4>
 <p>
 <em>avaje-inject</em> will generate a <code>StoreComponentModule</code> with the appropriate
 code to create/wire all the beans in the custom scope.
 <p>
 StoreComponentModule is typically found in <em>target/generate-sources/annotations</em>.
 For each component we will also see a <code>$DI</code> class which is the generated code
 that creates the component.

 <h4>4. Use the custom scope</h4>
 <p>
 To use the custom scope we specify the <code>StoreComponentModule</code> when creating the
 BeanScope. Only the components in our module will be create/wired into the BeanScope.
 <p>
 If the scope depends on another scope then we specify that using <code>withParent()</code>.

 <pre><code>

   BeanScope parentScope = ...

   BeanScope scope = BeanScope.newBuilder()
     .withModules(new StoreComponentModule())
     .withParent(parentScope)
     .build());

   StoreLoader storeLoader = scope.get(StoreLoader.class);
   storeLoader.load();

 </code></pre></div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div class="type-summary">
<table class="summary-table">
<caption><span>Interface Summary</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">Interface</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<th class="col-first" scope="row"><a href="BeanEntry.html" title="interface in io.avaje.inject">BeanEntry</a></th>
<td class="col-last">
<div class="block">A bean entry with priority and optional name.</div>
</td>
</tr>
<tr class="row-color">
<th class="col-first" scope="row"><a href="BeanScope.html" title="interface in io.avaje.inject">BeanScope</a></th>
<td class="col-last">
<div class="block">Holds beans created by dependency injection.</div>
</td>
</tr>
<tr class="alt-color">
<th class="col-first" scope="row"><a href="BeanScopeBuilder.html" title="interface in io.avaje.inject">BeanScopeBuilder</a></th>
<td class="col-last">
<div class="block">Build a bean scope with options for shutdown hook and supplying external dependencies.</div>
</td>
</tr>
<tr class="row-color">
<th class="col-first" scope="row"><a href="BeanScopeBuilder.ForTesting.html" title="interface in io.avaje.inject">BeanScopeBuilder.ForTesting</a></th>
<td class="col-last">
<div class="block">Extends the building with testing specific support for mocks and spies.</div>
</td>
</tr>
</tbody>
</table>
</div>
</li>
<li>
<div class="type-summary">
<table class="summary-table">
<caption><span>Annotation Types Summary</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">Annotation Type</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<th class="col-first" scope="row"><a href="Bean.html" title="annotation in io.avaje.inject">Bean</a></th>
<td class="col-last">
<div class="block">Marks methods on a <code>@Factory</code> bean that create dependencies.</div>
</td>
</tr>
<tr class="row-color">
<th class="col-first" scope="row"><a href="Factory.html" title="annotation in io.avaje.inject">Factory</a></th>
<td class="col-last">
<div class="block">A singleton bean that has methods marked with the <code>@Bean</code> annotation.</div>
</td>
</tr>
<tr class="alt-color">
<th class="col-first" scope="row"><a href="InjectModule.html" title="annotation in io.avaje.inject">InjectModule</a></th>
<td class="col-last">
<div class="block">Used to explicitly specify if it depends on externally provided beans or provides.</div>
</td>
</tr>
<tr class="row-color">
<th class="col-first" scope="row"><a href="PostConstruct.html" title="annotation in io.avaje.inject">PostConstruct</a></th>
<td class="col-last">
<div class="block">The <code>PostConstruct</code> annotation is used on a method that needs to be executed
 after dependency injection is done to perform any initialization.</div>
</td>
</tr>
<tr class="alt-color">
<th class="col-first" scope="row"><a href="PreDestroy.html" title="annotation in io.avaje.inject">PreDestroy</a></th>
<td class="col-last">
<div class="block">The <code>PreDestroy</code> annotation is used on a method as a callback notification
 to signal that the instance is in the process of being removed by the container.</div>
</td>
</tr>
<tr class="row-color">
<th class="col-first" scope="row"><a href="Primary.html" title="annotation in io.avaje.inject">Primary</a></th>
<td class="col-last">
<div class="block">Identify a bean as being the preferred bean to inject when multiple beans implement
 the intended interface.</div>
</td>
</tr>
<tr class="alt-color">
<th class="col-first" scope="row"><a href="Priority.html" title="annotation in io.avaje.inject">Priority</a></th>
<td class="col-last">
<div class="block">The <code>Priority</code> annotation can be applied to classes to indicate
 in what order they should be returned via @<a href="BeanScope.html#listByPriority(java.lang.Class)"><code>BeanScope.listByPriority(Class)</code></a>.</div>
</td>
</tr>
<tr class="row-color">
<th class="col-first" scope="row"><a href="Secondary.html" title="annotation in io.avaje.inject">Secondary</a></th>
<td class="col-last">
<div class="block">Identify a bean as being the least preferred bean to inject when multiple beans implement
 the intended interface.</div>
</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</section>
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottom-nav" id="navbar.bottom">
<div class="skip-nav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.bottom.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<span class="skip-nav" id="skip.navbar.bottom">
<!--   -->
</span></nav>
<p class="legal-copy"><small>Copyright &#169; 2021. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
